  {
    _id: ObjectId('675e7a261e5a105914ffa861'),
    r: 9,
    c: 9,
    tc: { mts: 30, is: 3, byt: null, ts: 0 },
    ts: [
      {
        st: '2024-12-15T12:11:42.9777430+05:30',
        mt: 30000,
        byl: null,
        bya: false,
        ta: false
      },
      {
        st: '2024-12-15T12:11:42.9777430+05:30',
        mt: 30000,
        byl: null,
        bya: false,
        ta: false
      }
    ],
    map: {},
    mv: [],
    p: [ '675e7a171e5a105914ffa85f', '675e7a1d1e5a105914ffa860'],
    pr: [ 0, 0 ],
    st: '2024-12-15T12:11:42.9777430+05:30',
    ko: null,
    gs: 4,
    ds: [],
    res: 0,
    fts: [],
    k: 6.5,
    gom: 1,
    et: '2024-12-15T12:11:49.6802786+05:30',
    sst: 1,
    gc: null,
    rt1: [ 30, -31 ],
    rt2: [ '1530', '1469' ],
    ty: 2
  }


  {
    _id: ObjectId('675e7a261e5a105914ffa861'),
    r: 9,
    c: 9,
    tc: { mts: 30, is: 3, byt: null, ts: 0 },
    ts: [
      {
        st: '2024-12-15T12:11:42.9777430+05:30',
        mt: 30000,
        byl: null,
        bya: false,
        ta: false
      },
      {
        st: '2024-12-15T12:11:42.9777430+05:30',
        mt: 30000,
        byl: null,
        bya: false,
        ta: false
      }
    ],
    map: {},
    mv: [],
    p: [ObjectId('675e7a171e5a105914ffa85f'), ObjectId('675e7a1d1e5a105914ffa860')],
    pr: [ 0, 0 ],
    st: '2024-12-15T12:11:42.9777430+05:30',
    ko: null,
    gs: 4,
    ds: [],
    res: 0,
    fts: [],
    k: 6.5,
    gom: 1,
    et: '2024-12-15T12:11:49.6802786+05:30',
    sst: 1,
    gc: null,
    rt1: [ 30, -31 ],
    rt2: [ '1530', '1469' ],
    ty: 2
  }





db.games.aggregate([
  {
    $lookup: {
      from: "users",
      let: { uids: "$p" },
      pipeline: [
        { $match: { $expr: { $and: [
          { $in: ["$_id", "$$uids"] },
          { $ne: ["$un", "taklu"] }
        ] }}}
      ],
      as: "o"
    }
  },
  {
    $lookup: {
      from: "users_ratings",
      let: { uids: "$p" },
      pipeline: [
        { $match: { $expr: { $and: [
          { $in: ["$_id", "$$uids"] },
          { $ne: ["$un", "taklu"] }
        ] }}}
      ],
      as: "r"
    }
  },
  {
    $project: {
      g: "$$ROOT",
	  o: {"$arrayElemAt" : ["$o" , 0]},
	  r: {"$arrayElemAt" : ["$r" , 0]}
    }
  }
]);


db.tempGames.aggregate( [
   {
     $lookup:
       {
         from: "users",
         localField: "p",
         foreignField: "_id",
         as: "pla"
       }
  }
] )
